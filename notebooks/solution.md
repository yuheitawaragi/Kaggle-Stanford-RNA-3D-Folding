## ðŸ¥‰Kaggle Stanford RNA 3D Folding Bronze (My Solution)

# Overview and goal

This repository contains my solution for the Kaggle competition "Stanford RNA 3D Folding".
The task is to predict the 3D structure of RNA molecules using only their nucleotide sequences.
Participants will build machine learning models that learn how RNA sequences fold into specific 3D conformations.
Accurate predictions will deepen our understanding of RNAâ€™s role in biology and contribute to advances in medicine and biotechnology.

# Approach

In this project, we predict RNA 3D structures from RNA sequences using an ensemble of DRfold2 and Protenix models.

### 1 Preparation for DRfold2

In this project, we initialize DRfold2 model and introduce physics-based scoring to select the top 3 energetically stable structures from the DRfold2 predictions. 

* Energy Scoring<br>
  Implements simplified biophysical scoring terms to evaluate RNA structures:<br>
   ãƒ» Van der Waals penalty (Lennard-Jones-like repulsion/attraction).<br>
   ãƒ» Hydrogen bond score (distance-based).<br>
   ãƒ» Electrostatic penalty (base-specific partial charges).<br>
   ãƒ» Bond angles and torsion angles (geometric stability).<br>
   ãƒ» Hydrogen bond directionality (penalizes non-linear H-bonds).<br>
  A weighted sum of these terms gives a total energy score for each structure candidate.

* DRfold2 Model Initialization<br>
  Loads pretrained DRfold2 model (RNA2nd + MSA2XYZ) from checkpoints.
  

### 2 Preparation for Protenix

This project performs Protenix runner initialization mainly.

* Defines a custom inference dataset class (DictDataset) to format RNA sequences as model input.
* Loads Protenix configurations (base, data, inference) and updates them with:<br>
       ãƒ» Number of diffusion cycles and sampling steps.<br>
       ãƒ» Path to pretrained checkpoint (model_v0.2.0.pt).
* Returns an InferenceRunner object and its configs, which are used for structure prediction.

### 3 Sequence Length Handling

* To avoid out-of-memory (OOM) errors, we truncate sequences to a maximum length (MAX_LENGTH = 900).
* During prediction, only the first 900 residues have predicted 3D coordinates.
* For residues beyond MAX_LENGTH, we still keep them in the output, but their coordinates are set to zeros (0.0).

### 4 Prediction using an ensemble of DRfold2 and Protenix

This project performs RNA 3D structure prediction using an ensemble of DRfold2 and Protenix.

* If the RNA sequence length is â‰¤ 480, 3 structures are generated by DRfold2 and 2 by Protenix, forming 5 predictions.
* If the sequence length is > 480, all 5 structures are generated by Protenix.
* For each sequence, the predicted coordinates of the C1â€² atom are saved into a submission.csv file in the required format.
